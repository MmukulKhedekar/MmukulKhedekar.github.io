---
linkTitle: GuessMyToken
title: GuessMyToken [Writeup]
type: docs
math: True
weight: 4
---
## Challenge Description

> This challenge is very easy, all you need to do is guess the 8 randomly generated bytes on each round.

## Solution 
As it is evident from the challenge description, the server generates an 8-byte long bytestring and our goal is to guess this bytestring within a time limit of 10 seconds. After every guess the server responds with a message that contains information for every nibble in our guess. This information tells us whether the nibble was accurate, lower or higher. 

### Linear Search: The Wrong Approach
At first, I immediately scripted a linear search to obtain the correct bytestring 

```py {filename=solve.py, linenos=table}
from Crypto.Util.number import *
from pwn import *

x = b'\x77' * 8
hex_val = hex(bytes_to_long(x))[2:]

r = remote('guess-my-token.rumble.host', 6903, level='DEBUG')

while True:
    r.recvuntil(b'Your guess: ')
    r.sendline(hex_val.encode())

    r.recvuntil(b'My control: ')
    result = r.recvline().strip().decode()

    new_hex = ""
    for i in range(len(result)):
        if result[i] == '↑':
            if hex_val[i] != '9':
                new_hex += chr(1 + ord(hex_val[i])) 
            else:
                new_hex += 'a'
        elif result[i] == '↓':
            if hex_val[i] != 'a':
                new_hex += chr(ord(hex_val[i]) - 1)
            else:
                new_hex += '9'
        else:
            new_hex += hex_val[i]
    hex_val = new_hex    
    print(hex_val)

r.interactive()

```

I realised sooner, however that the time limit was perhaps too strict for a linear search solution to pass. The server let's us guess only about 4 or 5 times before it timeouts. But then I realised we could optimise this further.

### Binary Search: The Correct Approach 
The idea is to binary search over the range $[0, 15]$ for every nibble in the string. This should terminate approximately within $\log_2(16)$ iterations which is sufficient for the amount of guesses the server let's us attempt.

### Solve Script
```py {filename=solve.py, linenos=table}
from Crypto.Util.number import *
from pwn import *

x = b'\x77' * 8
hex_val = hex(bytes_to_long(x))[2:]

l = [0 for i in range(16)]
r = [15 for i in range(16)]
c = [7 for i in range(16)]

p = remote('guess-my-token.rumble.host', 6903, level='DEBUG')

while True:
    p.recvuntil(b'Your guess: ')
    p.sendline(hex_val.encode())

    p.recvuntil(b'My control: ')
    result = p.recvline().strip().decode()

    new_hex = ""
    for i in range(len(result)):
        if result[i] == '↑':
            l[i] = c[i] + 1
            c[i] = (l[i] + r[i]) // 2
            new_hex += hex(c[i])[2:]

        elif result[i] == '↓':
            r[i] = c[i] - 1
            c[i] = (l[i] + r[i]) // 2
            new_hex += hex(c[i])[2:]
        else:
            new_hex += hex_val[i]
    hex_val = new_hex
    print(hex_val)

p.interactive()

## CSR{1_8uff0r3d_700_Much}
```

## Flag
```
CSR{1_8uff0r3d_700_Much}
```
